/* 
 lithe 
 @author xiaojue [designsor@gmail.com] 
 @fileoverview a javascript common loader 
 @vserion 0.2.1 
 */
(function(t,n){function e(t,n){return n=n||I,n?n.getElementsByTagName(t):n}function r(){}function i(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}function a(t){return"[object String]"===R.call(t)}function u(t){return"[object Function]"===R.call(t)}function o(t){var n={};return G(t,function(t){n[t]=1}),K(n)}function c(t,n){return t.getAttribute(n)}function s(t){var n=[];return t.replace(z,"").replace(D,function(t,e){n.push(e)}),o(n)}function f(t,e){var r;try{r=t(e.require,e.exports,e)}catch(i){throw Error(e.id+":"+i)}r!==n&&(e.exports=r)}function p(){this.map={}}function h(t){return t.indexOf("://")>0||0===t.indexOf("//")}function l(t){return!v(t)}function d(t){var n=t.match(/[^?]*(?=\/.*$)/);return(n?n[0]:".")+"/"}function v(t){return t.slice(t.lastIndexOf("/")+1).replace(/\?.*$/,"")}function g(t){var n=/([^:\/])\/\/+/g;if(n.lastIndex=0,n.test(t)&&(t=t.replace(n,"$1/")),-1===t.indexOf("."))return t;for(var e,r=t.split("/"),i=[],a=0;r.length>a;a++)if(e=r[a],".."===e){if(0===i.length)throw Error("The path is invalid: "+t);i.pop()}else"."!==e&&i.push(e);return i.join("/")}function m(t,n){t=g(t);var e=t.charAt(t.length-1);return"/"===e?t:("#"===e?t=t.slice(0,-1):-1!==t.indexOf("?")||/\.(?:js)$/.test(t)||(t+=".js"),t.indexOf(":80/")>0&&(t=t.replace(":80/","/")),n&&(t=t.replace(/\?.+$/,"")),t)}function y(t){var n,e,r,i,a,u={},o=rn.directorys;for(n=0;o.length>n&&!u[t];n++){i=o[n];for(a in i)if(e=i[a],r=RegExp("^"+a+"/"),r.test(t)&&!u[t]){t=t.replace(r,e),u[t]=!0;break}}return t}function x(t){var n=rn.alias;if(n){var e=n[t];return e?e:y(t)}return t}function b(t,n){if(n=d(n||on.basepath),h(t))return t;rn.init&&(t=x(t));var e="";return 0===t.indexOf("./")||0===t.indexOf("../")?(0===t.indexOf("./")&&(t=t.substring(2)),e=n+t):e="/"===t.charAt(0)&&"/"!==t.charAt(1)?n+t.substring(1):n+"/"+t,m(e)}function O(t,n){return nn[t]?(n(),void 0):Z[t]?(tn[t].push(n),void 0):(Z[t]=!0,tn[t]=[n],j(t,function(){nn[t]=!0,delete Z[t];var n=tn[t];n&&(delete tn[t],G(n,function(t){t()}))},M),void 0)}function j(t,e,r){var i=w("script",r);i.onload=i.onerror=i.onreadystatechange=function(){/loaded|complete|undefined/.test(i.readyState)&&(i.onload=i.onerror=i.onreadystatechange=null,i.parentNode&&!X&&i.parentNode.removeChild(i),i=n,u(e)&&e())},i.async="async",i.src=t,E(i)}function w(t,n){var e=I.createElement(t);return n&&(e.charset=n),e}function E(t){var n=e("base",L)[0];n?L.insertBefore(t,n):L.appendChild(t)}function $(t){var n=t.id,e=H(t.dependencies,function(t){un.push(n);var e=q(on.cache[b(t)]);return e&&un.push(n),un.pop(),!e});return _(e)}function q(t){if(!t||t.status!==an.save)return!1;un.push(t.id);var n=t.dependencies;if(n.length){if(A(n,un))return!0;for(var e=0;n.length>e;e++)if(q(on.cache[b(n[e])]))return!0}return un.pop(),!1}function A(t,n){var e=t.concat(n);return e.length>o(e).length}function _(t){return a(t)&&(t=[t]),J(t,function(t){return b(t)})}function S(t,n){function e(t){(t||{}).status<an.ready&&(t.status=an.ready),--a,0===a&&n()}t=_(t);var r=H(t,function(t){return t&&(!on.cache[t]||on.cache[t].status<an.ready)}),i=r.length;if(0===i)return n(),on.events.trigger("end"),void 0;var a=i;G(r,function(t){function n(){if(k(),r.status>=an.save){var t=$(r);t.length?S(t,function(){e(r)}):e(r)}else e()}var r=on.get(t);r.status<an.save?O(t,n):n()})}function k(){G(en,function(t){var n=on.get(t.id);n._save(t)}),en=[]}function N(t,n){S(t,function(){t=_(t);var e=J(t,function(t){return t?on.get(t)._compile():null});u(n)&&n.apply(null,e)})}function T(t){rn=t,rn.directorys=[];var n,e,r,i=rn.alias;if(i)for(n in i)e=i[n],l(e)&&(r={},r[n]=e,rn.directorys.push(r));rn.init=!0,rn.basepath&&(on.basepath=rn.basepath),on.config=rn}function B(t){this.id=t,this.status=0,this.dependencies=[],this.exports=null,this.parent=[],this.factory=r}var C=!(typeof window===n||!t.navigator||!t.document);if(C){var I=t.document,P=Array.prototype,F=Object,R=F.prototype.toString,z=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,D=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,G=P.forEach?function(t,n){t.forEach(n)}:function(t,n){for(var e=0;t.length>e;e++)n(t[e],e,t)},H=P.filter?function(t,n){return t.filter(n)}:function(t,n){var e=[];return G(t,function(t,r,i){n(t,r,i)&&e.push(t)}),e},J=P.map?function(t,n){return t.map(n)}:function(t,n){var e=[];return G(t,function(t,r,i){e.push(n(t,r,i))}),e},K=F.keys?F.keys:function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n};P.indexOf?function(t,n){return t.indexOf(n)}:function(t,n){for(var e=0;t.length>e;e++)if(t[e]===n)return e;return-1},i(p.prototype,{trigger:function(t,n){var e=this.map[t];e&&G(e,function(t){t.apply(this,n)})},on:function(t,n){this.map[t]?this.map[t].push(n):this.map[t]=[n]}});var L=I.head||e("head")[0]||I.documentElement,M="utf-8",Q=e("script"),U=Q[Q.length-1],V=c(U,"data-path")||U.src||c(U,"src"),W=c(U,"data-config"),X="true"===c(U,"data-debug"),Y=c(U,"data-main"),Z={},tn={},nn={},en=[],rn={},an={created:0,save:1,ready:2,compiling:3,compiled:4},un=[];i(B.prototype,{_compile:function(){function t(t){t=m(b(t),!0);var e=on.cache[t];return e?e.status===an.compiling?e.exports:(e.parent=n,e._compile()):null}var n=this;if(n.status===an.compiled)return n.exports;if(n.status<an.save)return null;n.status=an.compiling,t.cache=on.cache,n.require=t,n.exports={};var e=n.factory;return u(e)&&f(e,n),n.status=an.compiled,on.events.trigger("compiled",[n]),n.exports},_save:function(t){this.status<an.save&&(this.id=t.id,this.name=t.name,this.dependencies=t.deps,this.factory=t.factory,this.status=an.save)}});var on=i({basepath:V,events:new p,cache:{},get:function(t){return t=m(t,!0),on.cache[t]||(on.cache[t]=new B(t))},define:function(t,n){var e=s(""+n),r={id:b(t),name:t,deps:e,factory:n};en.push(r)},use:function(t,n){!W||rn.init?N(t,n):function(){k(),N(W,function(e){T(e),N(t,n)})}()}});t.lithe=on,t.define=on.define,Y&&setTimeout(function(){t.lithe.use(Y)})}else exports.tool=require("./lib/lithe-tool.js"),exports.hfs=require("./lib/lithe-hfs.js")})(this);
/* lithe-example |  | vserion 0.0.1*/
(function(e,t){var r,n,i=!(typeof window===t||!e.navigator||!e.document);i&&(r=/debug/.test(location.search),n=location.href.slice(0,location.href.lastIndexOf("/")));var l={basepath:r?n+"/src/":n+"/assest/",alias:{markdown:"mods/markdown"}};e.define&&i?define("config",function(){return l}):module.exports=l})(this);